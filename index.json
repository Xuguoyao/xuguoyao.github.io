[{"categories":["go"],"content":"å®‰è£…swag cli åŠä¸‹è½½ç›¸å…³åŒ… ","date":"2021-08-28","objectID":"/posts/swaggo/:1:0","tags":["go","swaggo"],"title":"ä½¿ç”¨swaggoæ—¶è¦æ³¨æ„çš„ä¸€ç‚¹","uri":"/posts/swaggo/"},{"categories":["go"],"content":"è¦ä½¿ç”¨swaggo,é¦–å…ˆéœ€è¦å®‰è£…swag cliã€‚ $ go get -u github.com/swaggo/swag/cmd/swag ç„¶åæˆ‘ä»¬è¿˜éœ€è¦ä¸¤ä¸ªåŒ…ã€‚ ","date":"2021-08-28","objectID":"/posts/swaggo/:1:1","tags":["go","swaggo"],"title":"ä½¿ç”¨swaggoæ—¶è¦æ³¨æ„çš„ä¸€ç‚¹","uri":"/posts/swaggo/"},{"categories":["go"],"content":"gin-swagger ä¸­é—´ä»¶ $ go get github.com/swaggo/gin-swagger ","date":"2021-08-28","objectID":"/posts/swaggo/:1:2","tags":["go","swaggo"],"title":"ä½¿ç”¨swaggoæ—¶è¦æ³¨æ„çš„ä¸€ç‚¹","uri":"/posts/swaggo/"},{"categories":["go"],"content":"swagger å†…ç½®æ–‡ä»¶ $ go get github.com/swaggo/gin-swagger/swaggerFiles ","date":"2021-08-28","objectID":"/posts/swaggo/:1:3","tags":["go","swaggo"],"title":"ä½¿ç”¨swaggoæ—¶è¦æ³¨æ„çš„ä¸€ç‚¹","uri":"/posts/swaggo/"},{"categories":["go"],"content":"åœ¨apiå¤„æ ¹æ®apiæ·»åŠ æè¿° import ( \"github.com/gin-gonic/gin\" ginSwagger \"github.com/swaggo/gin-swagger\" \"github.com/swaggo/gin-swagger/swaggerFiles\" ) // @title Swagger Example API // @version 1.0 // @description This is a sample server celler server. // @termsOfService https://razeen.me // @contact.name Razeen // @contact.url https://razeen.me // @contact.email me@razeen.me // @license.name Apache 2.0 // @license.url http://www.apache.org/licenses/LICENSE-2.0.html // @host 127.0.0.1:8080 // @BasePath /api/v1 func main() { r := gin.Default() store := sessions.NewCookieStore([]byte(\"secret\")) r.Use(sessions.Sessions(\"mysession\", store)) r.GET(\"/swagger/*any\", ginSwagger.WrapHandler(swaggerFiles.Handler)) v1 := r.Group(\"/api/v1\") { v1.GET(\"/hello\", HandleHello) } r.Run(\":8080\") } // @Summary æµ‹è¯•SayHello // @Description å‘ä½ è¯´Hello // @Tags æµ‹è¯• // @Accept mpfd // @Produce json // @Param who query string true \"äººå\" // @Success 200 {string} json \"{\"msg\": \"hello Razeen\"}\" // @Failure 400 {string} json \"{\"msg\": \"who are you\"}\" // @Router /hello [get] func HandleHello(c *gin.Context) { who := c.Query(\"who\") if who == \"\" { c.JSON(http.StatusBadRequest, gin.H{\"msg\": \"who are u?\"}) return } c.JSON(http.StatusOK, gin.H{\"msg\": \"hello \" + who}) } ä¿å­˜ä¹‹åå†å‘½ä»¤è¡Œå†™ swag init ","date":"2021-08-28","objectID":"/posts/swaggo/:1:4","tags":["go","swaggo"],"title":"ä½¿ç”¨swaggoæ—¶è¦æ³¨æ„çš„ä¸€ç‚¹","uri":"/posts/swaggo/"},{"categories":["go"],"content":"æˆåŠŸååœ¨ç»Ÿè®¡ç›®å½•ä¼šç”Ÿæˆä¸€ä¸ªdocsç›®å½•,é‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼š docs.go swagger.json swagger.yaml æœ€ågo run main,go ä¹ŸæˆåŠŸ åŸä»¥ä¸ºåœ¨æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/swagger/index.html è‚¯å®šæ˜¯æˆåŠŸçš„ï¼Œæ²¡æƒ³åˆ°é¡µé¢æ˜¾ç¤ºæ˜¯ Fetch errorInternal Server Error doc.json ä¸€å¼€å§‹å¯èƒ½æ˜¯æ³¨é‡Šå†™æ¼äº†æˆ–è€…æ˜¯å†™é”™äº†ï¼Œä½†æ˜¯å„ç§å°è¯•ä¿®æ”¹éƒ½ä¸è¡Œã€‚ æœ€åæŸ¥åˆ°è¯´æ˜¯éœ€è¦å¼•å…¥docsç›®å½•æ‰è¡Œã€‚ import ( \"github.com/gin-gonic/gin\" ginSwagger \"github.com/swaggo/gin-swagger\" \"github.com/swaggo/gin-swagger/swaggerFiles\" _ \"gin-admin/docs\" ) æœ€åç”¨ä¸Šé¢çš„æ–¹å¼æœç„¶æˆåŠŸ ","date":"2021-08-28","objectID":"/posts/swaggo/:1:5","tags":["go","swaggo"],"title":"ä½¿ç”¨swaggoæ—¶è¦æ³¨æ„çš„ä¸€ç‚¹","uri":"/posts/swaggo/"},{"categories":["php"],"content":"é€šè¿‡PHPExcleæŠŠexcleè¡¨å¯¼å…¥æ•°æ®åº“ï¼Œå˜æˆæ•°æ®è¡¨ï¼›ä¹Ÿå°±æ˜¯ä¸€ä¸ªexcleè¡¨å¯¹åº”å°±æ˜¯ä¸€ä¸ªæ•°æ®è¡¨ï¼š Excleè¡¨é‡Œçš„æ ¼å¼ä¸ºï¼š . A B C 1 å¯¹åº”æ•°æ®åº“çš„å­—æ®µ å¯¹åº”æ•°æ®åº“çš„å­—æ®µ å¯¹åº”æ•°æ®åº“çš„å­—æ®µ 2 å­—æ®µçš„æ³¨é‡Š å­—æ®µçš„æ³¨é‡Š å­—æ®µçš„æ³¨é‡Š 3 å€¼ å€¼ å€¼ ä»£ç ï¼š \u003c?php header(\"Content-Type:text/html;charset=utf-8\"); error_reporting(0); define('FY_MTIME',microtime(TRUE)); require_once 'inc/config.php'; $d = dir('xls/'); while (($file = $d-\u003eread()) !== false){ if(substr(strrchr($file, '.'), 1) == 'xls'){ $arr[] = $file; } } //æˆ‘æ˜¯æŠŠæ‰€æœ‰xlsæ–‡ä»¶åˆ—å‡ºåˆ—è¡¨ï¼Œå‹¾é€‰æäº¤åˆ°è¿™è¾¹$_POST foreach($_POST as $k =\u003e $item){ foreach($item as $v){ getExeclData('xls/'.$arr[$v]); } } /** * è·å–Execlè¡¨æ ¼æ•°æ® */ function getExeclData($file) { //é¦–å…ˆå¯¼å…¥PhPExcel require_once 'PHPExcel/PHPExcel.php'; $filePath = $file; if ($filePath == null || $filePath == '') { return; } $PHPReader = new PHPExcel_Reader_Excel5(); if (!$PHPReader-\u003ecanRead($filePath)) { echo 'no Excel'; return; } //å»ºç«‹excelå¯¹è±¡ï¼Œæ­¤æ—¶ä½ å³å¯ä»¥é€šè¿‡excelå¯¹è±¡è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ƒå†™å…¥æ–‡ä»¶ $PHPExcel = $PHPReader-\u003eload($filePath); /**è¯»å–excelæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨*/ $currentSheet = $PHPExcel-\u003egetSheet(0); /**å–å¾—æœ€å¤§çš„åˆ—å·*/ $allColumn = $currentSheet-\u003egetHighestColumn(); /**å–å¾—ä¸€å…±æœ‰å¤šå°‘è¡Œ*/ $allRow = $currentSheet-\u003egetHighestRow(); //ä¸‹é¢æ”¹æˆ'!=',æ‰€ä»¥æŠŠ$allColumn+1,'\u003c='å°±æœ‰é—®é¢˜ $allColumn++; //è·å–excleè¡¨ä¸­ç¬¬ä¸€è¡Œçš„å­—æ®µå $hdata = array(); $null = array(); for($colIndex='A'; $colIndex != $allColumn; $colIndex++){ $haddr = $colIndex . 1; //ç¼–å·A1ã€B1 $hcell = $currentSheet-\u003egetCell($haddr)-\u003egetValue(); //ç¼–å·å¯¹åº”çš„å€¼ if(!empty($hcell)){ array_push($hdata, $hcell); }else{ array_push($null[$colIndex], $hcell); } } //æŠŠexcelçš„ç©ºå­—æ®µç»„æˆæ•°ç»„ $key = array_keys($null); //è·å–xlsæ–‡ä»¶åï¼Œä¸æ•°æ®è¡¨åŒå $filePath = substr($filePath,strpos($filePath,'/')+1); $sheetName = explode('.',$filePath); $sheetName = $sheetName[0]; //æŠŠæ•°æ®è¡¨çš„å­—æ®µåˆ—å‡ºæ¥ foreach($hdata as $k =\u003e $item){ if(!empty($item)){ if($k == 0){ $field .= '`'.$item.'`'; }else{ $field .= ','.'`'.$item.'`'; } } } //ä¸éœ€è¦æ“ä½œçš„è¡¨ $jump = array( 0 =\u003e 't_const', 1 =\u003e 't_update_code', 2 =\u003e 't_properties_message', 3 =\u003e 't_error_code', 4 =\u003e 't_properties_mail' ); //è·³è¿‡ä¸éœ€è¦æ“ä½œçš„è¡¨ if(!in_array($sheetName, $jump)){ //æŠŠæ•°æ®è¡¨çš„åŸå…ˆæ•°æ®æ¸…ç©º $sSql = \"DELETE FROM \".$sheetName.\"\"; $res = mysql_query($sSql); if($res){ //å¾ªç¯è¯»å–æ¯ä¸ªå•å…ƒæ ¼çš„å†…å®¹ã€‚æ³¨æ„è¡Œä»3å¼€å§‹ï¼Œåˆ—ä»Aå¼€å§‹ for ($rowIndex = 3; $rowIndex \u003c= $allRow; $rowIndex++) { $data = array(); for($colIndex='A'; $colIndex!=$allColumn; $colIndex++){ //ç©ºå­—æ®µå¯¹åº”çš„åˆ—çš„æ•°æ®éƒ½ä¸æ’å…¥æ•°æ®è¡¨ if(!in_array($colIndex, $key)){ $addr = $colIndex . $rowIndex; $cell = $currentSheet-\u003egetCell($addr)-\u003egetValue(); if($cell instanceof PHPExcel_RichText){ //å¯Œæ–‡æœ¬è½¬æ¢å­—ç¬¦ä¸²ï¼Œä¸ç„¶å°±å‡ºç° PHPExcel_RichText Object $cell = $cell-\u003e__toString(); } array_push($data, $cell); } } foreach($data as $k =\u003e $item){ //é˜²æ­¢å’Œitemé‡Œçš„å¼•å·å†²çª if($k == 0){ $value .= '\"'.AddSlashes($item).'\"'; }else{ $value .= ','.'\"'.AddSlashes($item).'\"'; } } //æŠŠexcelè¡¨ä¸­çš„æ•°æ®éƒ½æ’å…¥æ•°æ®åº“ $sql = \"insert into \".$sheetName.\"(\".$field.\")\"; $sql .= \" values (\".$value.\")\"; $sql = 'insert into '.$sheetName.'('.$field.')'; $sql .= ' values ('.$value.')'; mysql_query('SET NAMES UTF8'); $res = mysql_query($sql); if($res){ //æ’å…¥æˆåŠŸ //echo 1; }else{ echo $sql.'\u003cbr /\u003e\u003cbr /\u003e'; //æ’å…¥å¤±è´¥ï¼Œæ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ //é”™è¯¯æ‰“log file_put_contents('errorlog/insert_error_'.$sheetName.'_'.date('Y-m-d').'.log','[START]------'.mysql_error().'------[END]'.date('Y-m-d H:i:s').PHP_EOL,FILE_APPEND); } unset($value); } }else{ echo mysql_error(); //é”™è¯¯æ‰“log file_put_contents('errorlog/delete_error_'.$sheetName.'_'.date('Y-m-d').'.log','[START]------'.mysql_error().'------[END]'.date('Y-m-d H:i:s').PHP_EOL,FILE_APPEND); } }else{ file_put_contents('errorlog/pass_'.$sheetName.'_'.date('Y-m-d').'.log','[START]------'.$sheetName.'è¡¨è·³è¿‡å¯¼å…¥------[END]'.date('Y-m-d H:i:s').PHP_EOL,FILE_APPEND); } unlink($filePath); sleep(1); } if(error_log()){ file_put_contents('errorlog/php_error_'.date('Y-m-d').'.log','[START]------'.error_log().'------[END]'.date('Y-m-d H:i:s').PHP_EOL,FILE_APPEND); } echo 'ç”¨æ—¶ï¼š'. ( microtime(TRUE) - FY_MTIME ); å¦‚æœå¯¼å…¥æ•°æ®åº“çš„æ•°æ®æœ‰å‡ºç°â€œ=æŸä¸ªå•å…ƒæ ¼â€ï¼ˆ=A3ï¼‰ï¼Œå°±å…ˆæŠŠ.xlsæ–‡ä»¶è½¬ä¸º.csvæ–‡ä»¶ï¼Œå†æŒ‰ä¸Šé¢çš„ä»£ç å¯¼å…¥æ•°æ®åº“ã€‚ è½¬æ ¼å¼çš„åšæ³•åœ¨ä¸‹é¢çš„é“¾æ¥é‡Œï¼š xlsæ–‡ä»¶è½¬csvæ–‡ä»¶ ","date":"2018-01-06","objectID":"/posts/php-excle/:0:0","tags":["php"],"title":"PHPExcleå¯¼excleè¡¨åˆ°æ•°æ®åº“","uri":"/posts/php-excle/"},{"categories":["php"],"content":"å½“è¦ä½¿ç”¨å¤šç»´æ•°ç»„ä¸­çš„æŸä¸ªå€¼æ¥ä½œæ’åºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼š ï¼ˆé€šè¿‡å­¦ä¹ ã€Šæ·±å…¥ç†è§£PHP é«˜çº§æŠ€å·§ã€é¢å‘å¯¹è±¡ä¸æ ¸å¿ƒæŠ€æœ¯ã€‹çš„æ–¹æ³•æ‰€å¾—ï¼‰ \u003c?php header(\"Content-type: text/html; charset=utf-8\"); $student = array( 256 =\u003e array('name' =\u003e 'C','grade' =\u003e 100), 2 =\u003e array('name' =\u003e 'A','grade' =\u003e 80), 9 =\u003e array('name' =\u003e 'D','grade' =\u003e 90), 364 =\u003e array('name' =\u003e 'E','grade' =\u003e 80), 68 =\u003e array('name' =\u003e 'B','grade' =\u003e 70), ); function name_sort($x,$y){ return strcasecmp($x['name'], $y['name']); } function grade_sort($x,$y){ return ($x['grade'] \u003c $y['grade']); } echo '\u003ch2\u003eåŸæœ¬æ•°ç»„ä¸º\u003c/h2\u003e\u003cpre\u003e'.print_r($student,1) .'\u003c/pre\u003e'; uasort($student, 'name_sort'); echo '\u003ch2\u003eé€šè¿‡åå­—æ’åºæ‰€å¾—æ•°ç»„\u003c/h2\u003e\u003cpre\u003e'.print_r($student,1) .'\u003c/pre\u003e'; uasort($student, 'grade_sort'); echo '\u003ch2\u003eé€šè¿‡æˆç»©æ’åºæ‰€å¾—æ•°ç»„\u003c/h2\u003e\u003cpre\u003e'.print_r($student,1) .'\u003c/pre\u003e'; ","date":"2017-11-16","objectID":"/posts/multidimensional-array-sorting/:0:0","tags":["php"],"title":"å¤šç»´æ•°ç»„æ’åº","uri":"/posts/multidimensional-array-sorting/"},{"categories":["php"],"content":"å¦‚æœæƒ³ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„åŸŸåæ¥è®¿é—®è‡ªå·±æœ¬åœ°çš„é¡¹ç›®ï¼Œæœ‰ä»¥ä¸‹æ­¥éª¤ï¼š 1ã€è¿›å…¥åˆ°â€œC:\\Windows\\System32\\drivers\\etcâ€çš„ç›®å½•ä¸‹ï¼Œæ‰¾åˆ° hosts è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€ä¿®æ”¹ï¼Œåœ¨æœ€åä¸€è¡Œå†™ä¸Šï¼š 127.0.0.1 www.xxxx.com å†™å¥½åä¿å­˜å…³é—­ï¼› 2ã€æ‰¾åˆ°Apacheä¸‹çš„ httpd.conf æ–‡ä»¶ï¼Œæ‰“å¼€ä¿®æ”¹ï¼ŒæŸ¥æ‰¾åˆ°â€œDocumentRootâ€çš„æ‰€åœ¨è¡Œï¼Œåœ¨åŸå…ˆçš„æ ¹ç›®å½•è·¯å¾„çš„åŸºç¡€ä¸ŠåŠ ä¸Šä½ çš„æ–‡ä»¶å¤¹åï¼Œå¦‚ï¼š åŸå…ˆçš„æ˜¯ï¼š DocumentRoot \"D:/wamp/www/\" ç°åœ¨æ”¹æˆï¼š DocumentRoot \"D:/wamp/www/tp\" å³å¯ ","date":"2017-08-15","objectID":"/posts/php-hosts/:0:0","tags":["php"],"title":"phpæœ¬åœ°åœ°å€æ”¹æˆåŸŸåè®¿é—®","uri":"/posts/php-hosts/"},{"categories":["linux"],"content":"åœ¨æœåŠ¡å™¨ä¸Šç”¨ vi -b æŸ¥çœ‹è„šæœ¬çš„æ—¶å€™ï¼Œå‘ç°é‡Œé¢æ¯ä¸€è¡Œç»“å°¾éƒ½æœ‰ ^M è¿™ä¸ªä¸œè¥¿ã€‚ è§£å†³åŠæ³•æ˜¯ï¼š 1.å…ˆ vi -b æ‰“è¦ä¿®æ”¹çš„è„šæœ¬ï¼› 2.æŒ‰ä¸€ä¸‹ Esc ï¼Œç„¶åè¾“å…¥ :%s/.$//g ï¼Œç„¶åå›è½¦ï¼› 3.ä¿å­˜é€€å‡ºå³å¯ã€‚ å† vi-b æŸ¥çœ‹æ—¶ï¼Œæ¯ä¸€è¡Œçš„ ^M å·²ç»ä¸è§äº† ","date":"2017-07-29","objectID":"/posts/linux-del-m/:0:0","tags":["linux"],"title":"Linuxä¸‹å»æ‰^Mçš„æ–¹æ³•","uri":"/posts/linux-del-m/"},{"categories":["php"],"content":"$aLines = Array ( [0] =\u003e Array ( [0] =\u003e 8 [1] =\u003e 30208201 [2] =\u003e 3 ) [1] =\u003e Array ( [0] =\u003e 1 [1] =\u003e 2 [2] =\u003e 1 ) [2] =\u003e Array ( [0] =\u003e 8 [1] =\u003e 30208204 [2] =\u003e 1 ) [3] =\u003e Array ( [0] =\u003e 8 [1] =\u003e 30208205 [2] =\u003e 1 ) ) $count = count($aLines);//ç»Ÿè®¡å¤šå°‘ä¸ªæ•°ç»„ if($count != 1){ $array=array(); $k = 0; $setsql = ' , had_attachment = 1 ';//æµ‹è¯• foreach($aLines as $arr){ if($arr[1] == 2){ $setsql .= \" , attachment_gold = \".$arr[1].\" \"; }else{ if (!array_key_exists($arr[1],$array)){ //æ£€æŸ¥é”®åæ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­,æ²¡æœ‰å°±å­˜è¿›å»ã€‚ $array[$k]=array($arr[1]); } $tab[$k][0]=$arr[0]; $tab[$k][1]=$arr[1]; $tab[$k][2]=$arr[2]; } $k++; } $w = json_encode(array_values($array)); $setsql .= \" , attachment_items = '\".$w.\"' \"; } echo $setsql; ","date":"2017-06-19","objectID":"/posts/splice-array/:0:0","tags":["php"],"title":"phpæ‹¼æ¥æ•°ç»„","uri":"/posts/splice-array/"},{"categories":["mysql"],"content":"åœ¨linuxä¸‹è¿æ¥äº†æ•°æ®åº“ä¹‹åï¼Œç½‘é¡µä¸Šæ˜¾ç¤ºAccess denied for user â€˜rootâ€™@â€™%â€™ to database â€˜xxxâ€™çš„å­—æ ·æ—¶ï¼Œ é€šè¿‡æ•°æ®åº“æˆæƒï¼š grant all on xxx.* to â€˜rootâ€™@â€™%â€™ identified by â€˜passwordâ€™ with grant option; å…¶ä¸­ï¼šxxxä»£è¡¨åˆ›å»ºçš„æ•°æ®åº“; passwordä¸ºç”¨æˆ·å¯†ç ã€‚ ","date":"2017-06-19","objectID":"/posts/access-denied/:0:0","tags":["mysql"],"title":"è®¿é—®ç½‘ç«™å‡ºç°Access denied for user 'root'@'%' to database 'xxx'","uri":"/posts/access-denied/"},{"categories":null,"content":"Hello Worldï¼ğŸ˜‚ ","date":"2017-06-09","objectID":"/posts/my-first-post.en/:0:0","tags":null,"title":"My First Post","uri":"/posts/my-first-post.en/"},{"categories":null,"content":"ä½ å¥½å‘€ï¼ğŸ˜‚ ","date":"2017-06-09","objectID":"/posts/my-first-post/:0:0","tags":null,"title":"æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢","uri":"/posts/my-first-post/"}]